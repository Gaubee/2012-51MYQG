<html>
<head>
  <title>利用URLRewriter重写url地址</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/267864 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1832"/>
<h1>利用URLRewriter重写url地址</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
原文：http://www.cnblogs.com/xlx0210/archive/2009/08/19/1550047.html 
<div> 首先，当然是下载URLRewriter了 <a href="http://download.microsoft.com/download/0/4/6/0463611e-a3f9-490d-a08c-877a83b797cf/MSDNURLRewriting.msi" target="_blank"><span style="color: #1d58d1">download.microsoft.com/download/0/4/6/0463611e-a3f9-490d-a08c-877a83b797cf/MSDNURLRewriting.msi</span></a>  下载安装后再bin目录下找到URLRewriter.dll文件
<p>    然后把这个文件引用到项目中，下面开始配置</p><p>   1 在web.config文件中加入如下代码 </p><div><span style="color: #0000ff">&lt;</span><span style="color: #800000">configuration</span><span style="color: #0000ff">&gt;</span><br>
  <span style="color: #0000ff">&lt;</span><span style="color: #800000">configSections</span><span style="color: #0000ff">&gt;</span><br>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">section </span><span style="color: #ff0000">name</span><span style="color: #0000ff">=&quot;RewriterConfig&quot;</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">=&quot;URLRewriter.Config.RewriterConfigSerializerSectionHandler, URLRewriter&quot;</span><span style="color: #ff0000"> </span><span style="color: #0000ff">/&gt;</span><br>
  <span style="color: #0000ff">&lt;/</span><span style="color: #800000">configSections</span><span style="color: #0000ff">&gt;</span><br><br><span style="color: #0000ff">&lt;/</span><span style="color: #800000">configuration</span><span style="color: #0000ff">&gt;</span></div><p>   其中</p><div><span style="color: #0000ff">&lt;</span><span style="color: #800000">section </span><span style="color: #ff0000">name</span><span style="color: #0000ff">=&quot;RewriterConfig&quot;</span><span style="color: #ff0000"> <br>
type</span><span style="color: #0000ff">=&quot;URLRewriter.Config.RewriterConfigSerializerSectionHandler, URLRewriter&quot;</span><span style="color: #ff0000"> </span><span style="color: #0000ff">/&gt;</span><br><span style="color: #0000ff">&lt;/</span><span style="color: #800000">configSections</span><span style="color: #0000ff">&gt;</span></div><p>用于指定配置节&quot;RewriterConfig&quot;的处理程序类的名称为”URLRewriter.Config.RewriterConfigSerializerSectionHandler”，该类存在于bin目录下的URLRewriter .dll文件中</p><p>  2 在web.config文件中的system.web节点下加入如下代码</p><div><span style="color: #0000ff">&lt;</span><span style="color: #800000">httpHandlers</span><span style="color: #0000ff">&gt;</span><br>
      <span style="color: #0000ff">&lt;</span><span style="color: #800000">add </span><span style="color: #ff0000">verb</span><span style="color: #0000ff">=&quot;*&quot;</span><span style="color: #ff0000"> path</span><span style="color: #0000ff">=&quot;*.html&quot;</span><span style="color: #ff0000"><br>
           type</span><span style="color: #0000ff">=&quot;URLRewriter.RewriterFactoryHandler, URLRewriter&quot;</span><span style="color: #ff0000"> </span><span style="color: #0000ff">/&gt;</span><br>
   <span style="color: #0000ff">&lt;/</span><span style="color: #800000">httpHandlers</span><span style="color: #0000ff">&gt;</span></div><p>    这段代码的意思是：将文件扩展名为 <code>.html</code> 的文件的所有 HTTP 请求映射到类 <code>URLRewriter.RewriterFactoryHandler 具体可以看MSDN，在这里我开始犯了个错误吧path=“*.html”写成了path=“*.aspx”导致了找不到页面，发生404的错误</code></p><p><code>   3 重写url</code></p><p>        和1一样 ，同样是放在<span style="color: #0000ff">&lt;</span><span style="color: #800000">configuration</span><span style="color: #0000ff">&gt;&lt;/<span style="color: #800000">configuration</span>&gt;<span style="color: #000000">节点下面</span></span> </p><p>     关键就是</p><p> </p><div><div><a title="复制代码"><img src="利用URLRewriter重写url地址_files/Image.gif" type="image/gif" alt="复制代码" style="cursor: default;cursor: default;"/></a></div><span style="color: #0000ff">&lt;</span><span style="color: #800000">RewriterConfig</span><span style="color: #0000ff">&gt;</span><br>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">Rules</span><span style="color: #0000ff">&gt;</span><br>
      <span style="color: #0000ff">&lt;</span><span style="color: #800000">RewriterRule</span><span style="color: #0000ff">&gt;</span><br>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">LookFor</span><span style="color: #0000ff">&gt;</span>~/Shownews/news(\d+)\.html<span style="color: #0000ff">&lt;/</span><span style="color: #800000">LookFor</span><span style="color: #0000ff">&gt;</span><br>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">SendTo</span><span style="color: #0000ff">&gt;</span>~/Shownews.aspx?ShowID=$1<span style="color: #0000ff">&lt;/</span><span style="color: #800000">SendTo</span><span style="color: #0000ff">&gt;</span><br>
      <span style="color: #0000ff">&lt;/</span><span style="color: #800000">RewriterRule</span><span style="color: #0000ff">&gt;</span><br>
      <span style="color: #0000ff">&lt;</span><span style="color: #800000">RewriterRule</span><span style="color: #0000ff">&gt;</span><br>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">LookFor</span><span style="color: #0000ff">&gt;</span>~/product(\d+)\.html<span style="color: #0000ff">&lt;/</span><span style="color: #800000">LookFor</span><span style="color: #0000ff">&gt;</span><br>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">SendTo</span><span style="color: #0000ff">&gt;</span>~/Showproduct.aspx?ShowID=$1<span style="color: #0000ff">&lt;/</span><span style="color: #800000">SendTo</span><span style="color: #0000ff">&gt;</span><br>
      <span style="color: #0000ff">&lt;/</span><span style="color: #800000">RewriterRule</span><span style="color: #0000ff">&gt;</span><br>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">Rules</span><span style="color: #0000ff">&gt;</span><br>
  <span style="color: #0000ff">&lt;/</span><span style="color: #800000">RewriterConfig</span><span style="color: #0000ff">&gt;</span><div><a title="复制代码"><img src="利用URLRewriter重写url地址_files/Image [1].gif" type="image/gif" alt="复制代码" style="cursor: default;cursor: default;"/></a></div></div><p> 其中关键在uml的转换 </p><div><span style="color: #0000ff">&lt;</span><span style="color: #800000">LookFor</span><span style="color: #0000ff">&gt;</span>~/Shownews/news(\d+)\.html<span style="color: #0000ff">&lt;/</span><span style="color: #800000">LookFor</span><span style="color: #0000ff">&gt;</span><br><br><span style="color: #0000ff">&lt;</span><span style="color: #800000">SendTo</span><span style="color: #0000ff">&gt;</span>~/Shownews.aspx?ShowID=$1<span style="color: #0000ff">&lt;/</span><span style="color: #800000">SendTo</span><span style="color: #0000ff">&gt;</span></div><p>      意思是把第一个路径转成另一个路径。其中&lt;LookFor&gt;（）中的正则表达式就是第二句中的参数$1 .</p><p>同样也可以用$2 $3来表示&lt;LookFor&gt;中第二 第三个（）中的参数。<br></p><p>现在总可以了吧，呵呵。终于看到了，兴奋吧。不要急，这还只是最简单的。如果你的页面有回传。比如说放了DATAGRID，有分页的，你点到下一页就发现，晕倒，又出问题了。<br>
这下怎么办呢，这个其实微软件的网站上就有说到，我在这里简述一下了。</p><p>第六步，加入窗体回传保持的组件：<br>
在原来你下载的项目里找到 ActionlessForm.dll 放到你的项目 bin 目录下。<br>
然后在你的这个页面中加入：<br>
&lt;%@ Register TagPrefix=&quot;skm&quot; Namespace=&quot;ActionlessForm&quot; Assembly=&quot;ActionlessForm&quot; %&gt;<br>
再把你的&lt;Form...&gt;改为：<br>
&lt;skm:Form id=&quot;你的表单名&quot; method=&quot;post&quot; runat=&quot;server&quot;&gt;<br>
.....<br>
&lt;/skm:Form&gt;<br>
That's All.现在你可以高枕无忧了</p></div></div>
</div></body></html> 