<html>
<head>
  <title>js获取本地文件夹和文件 .</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/267864 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1352"/>
<h1>js获取本地文件夹和文件 .</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><h1><a href="http://www.cnblogs.com/jcomet/archive/2012/02/06/2340005.html">js获取本地文件夹和文件 .</a></h1><div><p>一、功能实现核心：FileSystemObject 对象</p><p>要在javascript中实现文件操作功能，主要就是依靠FileSystem     object对象。</p><p>二、FileSystemObject编程</p><p>使用FileSystemObject 对象进行编程很简单，一般要经过如下的步骤： 创建FileSystemObject对象、应用相关方法、访问对象相关属性 。</p><p>（一）创建FileSystemObject对象</p><p>创建FileSystemObject对象的</p><p>代码只要1行：</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>上述代码执行后，fso就成为一个FileSystemObject对象实例。</p><p>（二）应用相关方法</p><p>创建对象实例后，就可以使用对象的相关方法了。比如，使用CreateTextFile方法创建一个文本文件：</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>var f1 = fso.createtextfile(&quot;c://myjstest.txt&quot;,true&quot;);</p><p>（三）访问对象相关属性</p><p>要访问对象的相关属性，首先要建立指向对象的句柄，这就要通过get系列方法实现：GetDrive负责获取驱动器信息，GetFolder负责获取文件夹信息，GetFile负责获取文件信息。比如，指向下面的代码后，f1就成为指向文件c:/test.txt的句柄：</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>var f1 = fso.GetFile(&quot;c://myjstest.txt&quot;);</p><p>然后，使用f1访问对象的相关属性。比如：</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>var f1 = fso.GetFile(&quot;c://myjstest.txt&quot;);</p><p>alert(&quot;File last modified: &quot; + f1.DateLastModified);</p><p>执行上面最后一句后，将显示c:/myjstest.txt的最后修改日期属性值。</p><p>但有一点请注意：对于使用create方法建立的对象，就不必再使用get方法获取对象句柄了，这时直接使用create方法建立的句柄名称就可以：</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>var f1 = fso.createtextfile(&quot;c://myjstest.txt&quot;,true&quot;);</p><p>alert(&quot;File last modified: &quot; + f1.DateLastModified);</p><p>三、操作驱动器（Drives）</p><p>使用FileSystemObject对象来编程操作驱动器（Drives）和文件夹（Folders）很容易，这就象在Windows文件浏览器中对文件进行交互操作一样，比如：拷贝、移动文件夹，获取文件夹的属性。</p><p>（一）Drives对象属性</p><p>Drive对象负责收集系统中的物理或逻辑驱动器资源内容，它具有如下属性：</p><p>l TotalSize：以字节（byte）为单位计算的驱动器大小。</p><p>l AvailableSpace或FreeSpace：以字节（byte）为单位计算的驱动器可用空间。</p><p>l DriveLetter：驱动器字母。</p><p>l DriveType：驱动器类型，取值为：removable（移动介质）、fixed（固定介质）、network（网络资源）、CD-ROM或者RAM盘。</p><p>l SerialNumber：驱动器的系列码。</p><p>l FileSystem：所在驱动器的文件系统类型，取值为FAT、FAT32和NTFS。</p><p>l IsReady：驱动器是否可用。</p><p>l ShareName：共享名称。</p><p>l VolumeName：卷标名称。</p><p>l Path和RootFolder：驱动器的路径或者根目录名称。</p><p>（二）Drive对象操作例程</p><p>下面的例程显示驱动器C的卷标、总容量和可用空间等信息：</p><p>var fso, drv, s =&quot;&quot;;</p><p>fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>drv = fso.GetDrive(fso.GetDriveName(&quot;c://&quot;));</p><p>s += &quot;Drive C:&quot; + &quot; - &quot;;</p><p>s += drv.VolumeName + &quot;/n&quot;;</p><p>s += &quot;Total Space: &quot; + drv.TotalSize / 1024;</p><p>s += &quot; Kb&quot; + &quot;/n&quot;;</p><p>s += &quot;Free Space: &quot; + drv.FreeSpace / 1024;</p><p>s += &quot; Kb&quot; + &quot;/n&quot;;</p><p>alert(s);</p><p>四、操作文件夹（Folders）</p><p>涉及到文件夹的操作包括创建、移动、删除以及获取相关属性。</p><p>Folder对象操作例程 :</p><p>下面的例程将练习获取父文件夹名称、创建文件夹、删除文件夹、判断是否为根目录等操作：</p><p>var fso, fldr, s = &quot;&quot;;</p><p>// 创建FileSystemObject对象实例</p><p>fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>// 获取Drive 对象</p><p>fldr = fso.GetFolder(&quot;c://&quot;);</p><p>// 显示父目录名称</p><p>alert(&quot;Parent folder name is: &quot; + fldr + &quot;/n&quot;);</p><p>// 显示所在drive名称</p><p>alert(&quot;Contained on drive &quot; + fldr.Drive + &quot;/n&quot;);</p><p>// 判断是否为根目录</p><p>if (fldr.IsRootFolder)</p><p>alert(&quot;This is the root folder.&quot;);</p><p>else</p><p>alert(&quot;This folder isn't a root folder.&quot;);</p><p>alert(&quot;/n/n&quot;);</p><p>// 创建新文件夹</p><p>fso.CreateFolder (&quot;C://Bogus&quot;);</p><p>alert(&quot;Created folder C://Bogus&quot; + &quot;/n&quot;);</p><p>// 显示文件夹基础名称，不包含路径名</p><p>alert(&quot;Basename = &quot; + fso.GetBaseName(&quot;c://bogus&quot;) + &quot;/n&quot;);</p><p>// 删除创建的文件夹</p><p>fso.DeleteFolder (&quot;C://Bogus&quot;);</p><p>alert(&quot;Deleted folder C://Bogus&quot; + &quot;/n&quot;);</p><p>五、操作文件（Files）</p><p>对文件进行的操作要比以上介绍的驱动器（Drive）和文件夹（Folder）操作复杂些，基本上分为以下两个类别：对文件的创建、拷贝、移动、删除操作和对文件内容的创建、添加、删除和读取操作。下面分别详细介绍。</p><p>（一）创建文件</p><p>一共有3种方法可用于创建一个空文本文件，这种文件有时候也叫做文本流（text stream）。</p><p>第一种是使用CreateTextFile方法。代码如下：</p><p>var fso, f1;</p><p>fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>f1 = fso.CreateTextFile(&quot;c://testfile.txt&quot;, true);</p><p>第二种是使用OpenTextFile方法，并添加上ForWriting属性，ForWriting的值为2。代码如下：</p><p>var fso, ts;</p><p>var ForWriting= 2;</p><p>fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>ts = fso.OpenTextFile(&quot;c://test.txt&quot;, ForWriting, true);</p><p>第三种是使用OpenAsTextStream方法，同样要设置好ForWriting属性。代码如下：</p><p>var fso, f1, ts;</p><p>var ForWriting = 2;</p><p>fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>fso.CreateTextFile (&quot;c://test1.txt&quot;);</p><p>f1 = fso.GetFile(&quot;c://test1.txt&quot;);</p><p>ts = f1.OpenAsTextStream(ForWriting, true);</p><p>（二）添加数据到文件</p><p>当文件被创建后，一般要按照“打开文件－&gt;填写数据－&gt;关闭文件”的步骤实现添加数据到文件的目的。</p><p>打开文件可使用FileSystemObject对象的OpenTextFile方法，或者使用File对象的OpenAsTextStream方法。</p><p>填写数据要使用到TextStream对象的Write、WriteLine或者WriteBlankLines方法。在同是实现写入数据的功能 下，这3者的区别在于：Write方法不在写入数据末尾添加新换行符，WriteLine方法要在最后添加一个新换行符，而 WriteBlankLines则增加一个或者多个空行。</p><p>关闭文件可使用TextStream对象的Close方法。</p><p>（三）创建文件及添加数据例程</p><p>下面的代码将创建文件、添加数据、关闭文件几个步骤结合起来进行应用：</p><p>var fso, tf;</p><p>fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>// 创建新文件</p><p>tf = fso.CreateTextFile(&quot;c://testfile.txt&quot;, true);</p><p>// 填写数据，并增加换行符</p><p>tf.WriteLine(&quot;Testing 1, 2, 3.&quot;) ;</p><p>// 增加3个空行</p><p>tf.WriteBlankLines(3) ;</p><p>// 填写一行，不带换行符</p><p>tf.Write (&quot;This is a test.&quot;);</p><p>// 关闭文件</p><p>tf.Close();</p><p>（四）读取文件内容</p><p>从文本文件中读取数据要使用TextStream对象的Read、ReadLine或ReadAll 方法。Read方法用于读取文件中指定数量的字符； ReadLine方法读取一整行，但不包括换行符；ReadAll方法则读取文本文件的整个内容。读取的内容存放于字符串变量中，用于显示、分析。</p><p> </p><p>方法或者属性 描述</p><p>BuildPath()</p><p>生成一个文件路径</p><p>CopyFile() 复制文件</p><p>CopyFolder() 复制目录</p><p>CreateFolder() 创建新目录</p><p>CreateTextFile() 生成一个文件</p><p>DeleteFile() 删除一个文件</p><p>DeleteFolder() 删除一个目录</p><p>DriveExists() 检验盘符是否存在</p><p>Drives 返回盘符的集合</p><p>FileExists() 检验文件是否存在</p><p>FolderExists 检验一个目录是否存在</p><p>GetAbsolutePathName() 取得一个文件的绝对路径</p><p>GetBaseName() 取得文件名</p><p>GetDrive() 取得盘符名</p><p>GetDriveName() 取得盘符名</p><p>GetExtensionName() 取得文件的后缀</p><p>GetFile() 生成文件对象</p><p>GetFileName() 取得文件名</p><p>GetFolder() 取得目录对象</p><p>GetParentFolderName 取得文件或目录的父目录名</p><p>GetSpecialFolder() 取得特殊的目录名</p><p>GetTempName() 生成一个临时文件对象</p><p>MoveFile() 移动文件</p><p>MoveFolder() 移动目录</p><p>OpenTextFile() 打开一个文件流</p><p> </p><p>f.Files //目录下所有文件集合</p><p>f.attributes //文件属性</p><p>Case 0 Str=&quot;普通文件。没有设置任何属性。 &quot;</p><p>Case 1 Str=&quot;只读文件。可读写。 &quot;</p><p>Case 2 Str=&quot;隐藏文件。可读写。 &quot;</p><p>Case 4 Str=&quot;系统文件。可读写。 &quot;</p><p>Case 16 Str=&quot;文件夹或目录。只读。 &quot;</p><p>Case 32 Str=&quot;上次备份后已更改的文件。可读写。 &quot;</p><p>Case 1024 Str=&quot;链接或快捷方式。只读。 &quot;</p><p>Case 2048 Str=&quot; 压缩文件。只读。&quot;</p><p>f.Datecreated // 创建时间</p><p>f.DateLastAccessed //上次访问时间</p><p>f.DateLastModified // 上次修改时间</p><p>f.Path //文件路径</p><p>f.Name //文件名称</p><p>f.Type //文件类型</p><p>f.Size // 文件大小（单位：字节）</p><p>f.ParentFolder //父目录</p><p>f.RootFolder // 根目录</p><p> </p><p> </p><p> </p><p> </p><p>实例说明</p><p>BuildPath(路径,文件名) //这个方法会对给定的路径加上文件，并自动加上分界符</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>var newpath = fso.BuildPath(&quot;c://tmp&quot;, &quot;51js.txt&quot;); //生成 c:/tmp/51js.txt的路径</p><p>alert(newpath);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>CopyFile(源文件, 目标文件, 覆盖) //复制源文件到目标文件，当覆盖值为true时，如果目标文件存在会把文件覆盖</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>var newpath = fso.CopyFile(&quot;c://autoexec.bat&quot;, &quot;d://autoexec.bak&quot;);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>CopyFolder(对象目录,目标目录 ,覆盖) //复制对象目录到目标目录，当覆盖为true时，如果目标目录存在会把文件覆盖</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>fso.CopyFolder(&quot;c://WINDOWS//Desktop&quot;, &quot;d://&quot;); //把C盘的Desktop目录复制到D盘的根目录</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>CreateFolder(目录名) //创建一个新的目录</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>var newFolderName = fso.CreateFolder(&quot;c://51JS&quot;); //在C盘上创建一个51JS的目录</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>CreateTextFile(文件名, 覆盖) //创建一个新的文件，如果此文件已经存在，你需要把覆盖值定为true</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>var newFileObject = fso.CreateTextFile(&quot;c://autoexec51JS.bat&quot;, true); //脚本将在C盘创建一个叫 autoexec51JS.bat的文件</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>DeleteFile(文件名, 只读？) //删除一个文件，如果文件的属性是只读的话，你需要把只读值设为true</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;); //为了安全我先把要删除的autoexec.bat备份到你的D盘</p><p>var newpath = fso.CopyFile(&quot;c://autoexec.bat&quot;, &quot;d://autoexec.bat&quot;); //把C盘的autoexec.bat文件删除掉</p><p>fso.DeleteFile(&quot;c://autoexec.bat&quot;, true);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>DeleteFolder(文件名, 只读？)//删除一个目录，如果目录的属性是只读的话，你需要把只读值设为true</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>fso.CopyFolder(&quot;c://WINDOWS//Desktop&quot;, &quot;d://&quot;); //为了安全我先把你C盘的Desktop目录复制到你D盘的根目录</p><p>fso.DeleteFolder(&quot;c://WINDOWS//Desktop&quot;, true); //把你的Desktop目录删除，但因为desktop是系统的东西，所以不能全部删除，但.........</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>DriveExists(盘符) //检查一个盘是否存在，如果存在就返会真，不存在就返回.......</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>hasDriveD = fso.DriveExists(&quot;d&quot;); //检查系统是否有D盘存在</p><p>hasDriveZ = fso.DriveExists(&quot;z&quot;); //检查系统是否有Z盘存在</p><p>if (hasDriveD) alert(&quot;你的系统内有一个D盘&quot;);</p><p>if (!hasDriveZ) alert(&quot;你的系统内没有Z盘&quot;);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>FileExists(文件名) //检查一个文件是否存在，如果存在就返会真，不存在就返回.......</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>fileName = fso.FileExists(&quot;c://autoexec.bat&quot;);</p><p>if (fileName) alert(&quot;你在C盘中有autoexec.bat文件，按下确定后这个文件将被删除！&quot;); //开个玩笑:)</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>FolderExists(目录名) //检查一个目录是否存在，如果存在就返会真，不存在就返回.......</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>folderName = fso.FolderExists(&quot;c://WINDOWS//Fonts&quot;);</p><p>if (folderName) alert(&quot;按下确定后系统的字库将被删除！&quot;); //开个玩笑:)</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>GetAbsolutePathName(文件对象) //返回文件对象在系统的绝对路径</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>pathName = fso.GetAbsolutePathName(&quot;c://autoexec.bat&quot;);</p><p>alert(pathName);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>GetBaseName(文件对象) //返回文件对象的文件名</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>baseName = fso.GetBaseName(&quot;c://autoexec.bat&quot;); //取得autoexec.bat的文件名autoexec</p><p>alert(baseName);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>GetExtensionName(文件对象) //文件的后缀</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>exName = fso.GetExtensionName(&quot;c://autoexec.bat&quot;); //取得autoexec.bat后缀bat</p><p>alert(exName);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>GetParentFolderName(文件对象) //取得父级的目录名</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>parentName = fso.GetParentFolderName(&quot;c://autoexec.bat&quot;); //取得autoexec.bat的父级目录C盘</p><p>alert(parentName);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>GetSpecialFolder(目录代码) //取得系统中一些特别的目录的路径，目录代码有3个分别是 0:安装Window的目录 1:系统文件目录 2:临时文件目录</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>tmpFolder = fso.GetSpecialFolder(2); //取得系统临时文件目录的路径 如我的是 C:/windows/temp</p><p>alert(tmpFolder);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>GetTempName() //生成一个随机的临时文件对象，会以rad带头后面跟着些随机数，就好象一些软件在安装时会生成*.tmp</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>tmpName = fso.GetTempName(); //我在测试时就生成了radDB70E.tmp</p><p>alert(tmpName);</p><p>--&gt;</p><p>&lt;/SCRIPT&gt;</p><p>MoveFile(源文件, 目标文件) //把源文件移到目标文件的位置</p><p>&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;</p><p>&lt;!--</p><p>var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);</p><p>var newpath = fso.MoveFile(&quot;c://autoexec.bat&quot;, &quot;d://autoexec.bat&quot;); //把C盘的autoexec.bat文件移移动到D盘</p><p>--&gt;</p></div></div>
</div></body></html> 