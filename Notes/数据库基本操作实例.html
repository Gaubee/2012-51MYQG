<html>
<head>
  <title>数据库基本操作实例</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/267864 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="990"/>
<h1>数据库基本操作实例</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left"><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">DECLARE</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">@a</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">int</span></font> <font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">--</span></font><font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">定义变量</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">create</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">table</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">#Tmp</span></font> <font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">--</span></font><font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">创建临时表</span></font> <font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">#Tmp</span></font> <font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">用来存放</span></font><font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">ID</span></font> <font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">，最后输出</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">    ID  </span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">int</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">IDENTITY</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">1</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">1</span></font><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">)</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">not</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">null,</span></font> <font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">--</span></font> <font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">创建列</span></font><font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">ID,</span></font><font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">并且每次新增一条记录就会加</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">    AdmPeopleID </span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">int</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt"> </span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">   </span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">primary</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">key</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">ID</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">)</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">--</span></font> <font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">定义</span></font> <font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">ID</span></font><font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">为临时表</span></font><font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">#Tmp</span></font> <font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">的主键</span></font><font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">   </span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">set</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">@a</span></font><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">0</span></font> <font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">--</span></font><font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">初始化默认值</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">select</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">@a</span></font><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">id  </span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">from</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">TestTable</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">where</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">[name]</span></font><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font color="#FF0000" face="Courier New" size="2"><span style="font-size:10pt">'</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">洪敏</span></font> <font color="#FF0000" face="Courier New" size="2"><span style="font-size:10pt">'</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">and</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">sex</span></font><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">1</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">print</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">@a</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">if</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">@a</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font color="#FF0000" face="Courier New" size="2"><span style="font-size:10pt">''</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">or</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">@a</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">NULL</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">or</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">@a</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">0</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">begin</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">insert</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">into</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">TestTable</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">[name]</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">sex</span></font><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">)</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">values</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font color="#FF0000" face="Courier New" size="2"><span style="font-size:10pt">'</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">洪敏</span></font> <font color="#FF0000" face="Courier New" size="2"><span style="font-size:10pt">'</span></font><font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">1</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">insert</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">into</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">#Tmp</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">AdmPeopleID</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">)</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">values</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font color="#FF00FF" face="Courier New" size="2"><span style="font-size:10pt">@@IDENTITY</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">print</span></font> <font color="#FF0000" face="Courier New" size="2"><span style="font-size:10pt">'</span></font> <font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">不存在</span></font><font color="#FF0000" face="Courier New" size="2"><span style="font-size:10pt">'</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">print</span></font> <font color="#FF00FF" face="Courier New" size="2"><span style="font-size:10pt">@@IDENTITY</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">end</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">else</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">begin</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">print</span></font> <font color="#FF0000" face="Courier New" size="2"><span style="font-size:10pt">'</span></font> <font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">存在</span></font><font color="#FF0000" face="Courier New" size="2"><span style="font-size:10pt">'</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">insert</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">into</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">#Tmp</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">AdmPeopleID</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">)</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">values</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">@a</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">end</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">select</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">from</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">testtable</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">Select</span></font> <font color="#808080" face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">from</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">#Tmp</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'"><font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">drop</span></font> <font color="#0000FF" face="Courier New" size="2"><span style="font-size:10pt">table</span></font> <font color="#010101" face="Courier New" size="2"><span style="font-size:10pt">#Tmp</span></font> <font color="#008000" face="Courier New" size="2"><span style="font-size:10pt">--</span></font><font color="#008000" face="Times New Roman" size="2"><span style="font-size:10pt">删除临时表</span></font></font></div><div align="left"><font color="#0000FF" face="'Courier New'">  </font></div></div></div>
</div></body></html> 